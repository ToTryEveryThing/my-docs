import{u as _,f as le,g as te,h as U,i as se,P as ae,t as re,j as oe,k as E,l as w,m as ie,n as Y,p as t,q as ue,R as O,s as ne,v as ce,x as he,C as ve,y as me,z as pe,A as ye,B as ge,D as de,E as be,F as ke,G as T,H as $,I as fe,J as q,K as Se}from"./app-PTE6orPW.js";const He=["/","/blog/","/blog/Microservices/ElasticSearch.html","/blog/Microservices/","/blog/Microservices/SpringCloud.html","/blog/Microservices/rabbitmq.html","/blog/Microservices/redis.html","/blog/SSM/Mybatis.html","/blog/SSM/MybatisPlus.html","/blog/SSM/","/blog/SSM/mysql.html","/blog/SSM/quartz.html","/blog/SSM/ssm.html","/blog/itheima/","/blog/markmap/","/blog/markmap/main.html","/blog/other/Git.html","/blog/other/Maven.html","/blog/other/Nginx.html","/blog/other/","/blog/other/alioss.html","/blog/other/book.html","/blog/other/linux.html","/blog/tools/Jenkins.html","/blog/tools/Puppeteer.html","/blog/tools/","/blog/tools/action.html","/blog/tools/cron.html","/blog/tools/jasypt.html","/blog/tools/regex.html","/blog/worklogs/","/blog/worklogs/mysql.html","/blog/worklogs/pdf.html","/blog/worklogs/principle.html","/blog/worklogs/xml.html","/blog/itheima/Netty/Netty01-nio.html","/blog/itheima/Netty/Netty02.html","/blog/itheima/Netty/Netty03.html","/blog/itheima/Netty/Netty04.html","/blog/itheima/Netty/","/404.html"],Re="SEARCH_PRO_QUERY_HISTORY",d=_(Re,[]),we=()=>{const{queryHistoryCount:s}=q,a=s>0;return{enabled:a,queryHistory:d,addQueryHistory:r=>{a&&(d.value=Array.from(new Set([r,...d.value.slice(0,s-1)])))},removeQueryHistory:r=>{d.value=[...d.value.slice(0,r),...d.value.slice(r+1)]}}},P=s=>He[s.id]+("anchor"in s?`#${s.anchor}`:""),qe="SEARCH_PRO_RESULT_HISTORY",{resultHistoryCount:I}=q,b=_(qe,[]),xe=()=>{const s=I>0;return{enabled:s,resultHistory:b,addResultHistory:a=>{if(s){const r={link:P(a),display:a.display};"header"in a&&(r.header=a.header),b.value=[r,...b.value.slice(0,I-1)]}},removeResultHistory:a=>{b.value=[...b.value.slice(0,a),...b.value.slice(a+1)]}}},Qe=s=>{const a=ve(),r=U(),x=me(),i=E(0),S=w(()=>i.value>0),p=pe([]);return ye(()=>{const{search:y,terminate:Q}=ge(),k=fe(c=>{const f=c.join(" "),{searchFilter:M=m=>m,splitWord:C,suggestionsFilter:A,...g}=a.value;f?(i.value+=1,y(c.join(" "),r.value,g).then(m=>M(m,f,r.value,x.value)).then(m=>{i.value-=1,p.value=m}).catch(m=>{console.warn(m),i.value-=1,i.value||(p.value=[])})):p.value=[]},q.searchDelay-q.suggestDelay);Y([s,r],([c])=>k(c),{immediate:!0}),de(()=>{Q()})}),{isSearching:S,results:p}};var Ce=le({name:"SearchResult",props:{queries:{type:Array,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(s,{emit:a}){const r=te(),x=U(),i=se(ae),{enabled:S,addQueryHistory:p,queryHistory:y,removeQueryHistory:Q}=we(),{enabled:k,resultHistory:c,addResultHistory:f,removeResultHistory:M}=xe(),C=S||k,A=re(s,"queries"),{results:g,isSearching:m}=Qe(A),o=oe({isQuery:!0,index:0}),h=E(0),v=E(0),F=w(()=>C&&(y.value.length>0||c.value.length>0)),D=w(()=>g.value.length>0),L=w(()=>g.value[h.value]||null),z=()=>{const{isQuery:e,index:l}=o;l===0?(o.isQuery=!e,o.index=e?c.value.length-1:y.value.length-1):o.index=l-1},B=()=>{const{isQuery:e,index:l}=o;l===(e?y.value.length-1:c.value.length-1)?(o.isQuery=!e,o.index=0):o.index=l+1},G=()=>{h.value=h.value>0?h.value-1:g.value.length-1,v.value=L.value.contents.length-1},J=()=>{h.value=h.value<g.value.length-1?h.value+1:0,v.value=0},K=()=>{v.value<L.value.contents.length-1?v.value+=1:J()},V=()=>{v.value>0?v.value-=1:G()},N=e=>e.map(l=>Se(l)?l:t(l[0],l[1])),W=e=>{if(e.type==="customField"){const l=be[e.index]||"$content",[u,R=""]=ke(l)?l[x.value].split("$content"):l.split("$content");return e.display.map(n=>t("div",N([u,...n,R])))}return e.display.map(l=>t("div",N(l)))},H=()=>{h.value=0,v.value=0,a("updateQuery",""),a("close")},X=()=>S?t("ul",{class:"search-pro-result-list"},t("li",{class:"search-pro-result-list-item"},[t("div",{class:"search-pro-result-title"},i.value.queryHistory),y.value.map((e,l)=>t("div",{class:["search-pro-result-item",{active:o.isQuery&&o.index===l}],onClick:()=>{a("updateQuery",e)}},[t(T,{class:"search-pro-result-type"}),t("div",{class:"search-pro-result-content"},e),t("button",{class:"search-pro-remove-icon",innerHTML:$,onClick:u=>{u.preventDefault(),u.stopPropagation(),Q(l)}})]))])):null,Z=()=>k?t("ul",{class:"search-pro-result-list"},t("li",{class:"search-pro-result-list-item"},[t("div",{class:"search-pro-result-title"},i.value.resultHistory),c.value.map((e,l)=>t(O,{to:e.link,class:["search-pro-result-item",{active:!o.isQuery&&o.index===l}],onClick:()=>{H()}},()=>[t(T,{class:"search-pro-result-type"}),t("div",{class:"search-pro-result-content"},[e.header?t("div",{class:"content-header"},e.header):null,t("div",e.display.map(u=>N(u)).flat())]),t("button",{class:"search-pro-remove-icon",innerHTML:$,onClick:u=>{u.preventDefault(),u.stopPropagation(),M(l)}})]))])):null;return ie("keydown",e=>{if(s.isFocusing){if(D.value){if(e.key==="ArrowUp")V();else if(e.key==="ArrowDown")K();else if(e.key==="Enter"){const l=L.value.contents[v.value];p(s.queries.join(" ")),f(l),r.push(P(l)),H()}}else if(k){if(e.key==="ArrowUp")z();else if(e.key==="ArrowDown")B();else if(e.key==="Enter"){const{index:l}=o;o.isQuery?(a("updateQuery",y.value[l]),e.preventDefault()):(r.push(c.value[l].link),H())}}}}),Y([h,v],()=>{var e;(e=document.querySelector(".search-pro-result-list-item.active .search-pro-result-item.active"))==null||e.scrollIntoView(!1)},{flush:"post"}),()=>t("div",{class:["search-pro-result-wrapper",{empty:s.queries.length?!D.value:!F.value}],id:"search-pro-results"},s.queries.length?m.value?t(ue,{hint:i.value.searching}):D.value?t("ul",{class:"search-pro-result-list"},g.value.map(({title:e,contents:l},u)=>{const R=h.value===u;return t("li",{class:["search-pro-result-list-item",{active:R}]},[t("div",{class:"search-pro-result-title"},e||i.value.defaultTitle),l.map((n,ee)=>{const j=R&&v.value===ee;return t(O,{to:P(n),class:["search-pro-result-item",{active:j,"aria-selected":j}],onClick:()=>{p(s.queries.join(" ")),f(n),H()}},()=>[n.type==="text"?null:t(n.type==="title"?ne:n.type==="heading"?ce:he,{class:"search-pro-result-type"}),t("div",{class:"search-pro-result-content"},[n.type==="text"&&n.header?t("div",{class:"content-header"},n.header):null,t("div",W(n))])])})])})):i.value.emptyResult:C?F.value?[X(),Z()]:i.value.emptyHistory:i.value.emptyResult)}});export{Ce as default};
