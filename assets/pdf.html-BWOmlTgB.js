import{_ as p}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r as e,o,c,a as n,d as s,b as t,e as l}from"./app-BEUY8XuZ.js";const u={},i=n("h1",{id:"使用itext5导出pdf",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#使用itext5导出pdf","aria-hidden":"true"},"#"),s(" 使用itext5导出pdf")],-1),k={href:"https://www.cnblogs.com/hm201402/p/17803521.html",target:"_blank",rel:"noopener noreferrer"},r={href:"https://blog.csdn.net/ZF_On_The_Way/article/details/134412191",target:"_blank",rel:"noopener noreferrer"},d={href:"https://blog.csdn.net/cjqcsdn/article/details/105608028",target:"_blank",rel:"noopener noreferrer"},m=l(`<h2 id="依赖" tabindex="-1"><a class="header-anchor" href="#依赖" aria-hidden="true">#</a> 依赖</h2><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code>    <span class="token comment">&lt;!--        生成pdf--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.itextpdf<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>itextpdf<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>5.5.13<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!--        字体--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.itextpdf<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>itext-asian<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>5.2.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!--        工具类--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.itextpdf.tool<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>xmlworker<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>5.5.13<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="配置中文字体" tabindex="-1"><a class="header-anchor" href="#配置中文字体" aria-hidden="true">#</a> 配置中文字体</h2><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * <span class="token keyword">@author</span> mishu
 * <span class="token keyword">@since</span> 2024/7/17
 * <span class="token keyword">@description</span> 解决pdf文件中文不显示的问题
 */</span>
<span class="token annotation punctuation">@Slf4j</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AsianFontProvider</span> <span class="token keyword">extends</span> <span class="token class-name">XMLWorkerFontProvider</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token class-name">Font</span> <span class="token function">getFont</span><span class="token punctuation">(</span><span class="token keyword">final</span> <span class="token class-name">String</span> fontname<span class="token punctuation">,</span> <span class="token keyword">final</span> <span class="token class-name">String</span> encoding<span class="token punctuation">,</span>
                        <span class="token keyword">final</span> <span class="token keyword">boolean</span> embedded<span class="token punctuation">,</span> <span class="token keyword">final</span> <span class="token keyword">float</span> size<span class="token punctuation">,</span> <span class="token keyword">final</span> <span class="token keyword">int</span> style<span class="token punctuation">,</span>
                        <span class="token keyword">final</span> <span class="token class-name">BaseColor</span> color<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">BaseFont</span> bf <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            bf <span class="token operator">=</span> <span class="token class-name">BaseFont</span><span class="token punctuation">.</span><span class="token function">createFont</span><span class="token punctuation">(</span><span class="token string">&quot;STSong-Light&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;UniGB-UCS2-H&quot;</span><span class="token punctuation">,</span> <span class="token class-name">BaseFont</span><span class="token punctuation">.</span><span class="token constant">NOT_EMBEDDED</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&quot;生成pdf文件，添加字体失败&quot;</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">Font</span> font <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Font</span><span class="token punctuation">(</span>bf<span class="token punctuation">,</span> size<span class="token punctuation">,</span> style<span class="token punctuation">,</span> color<span class="token punctuation">)</span><span class="token punctuation">;</span>
        font<span class="token punctuation">.</span><span class="token function">setColor</span><span class="token punctuation">(</span>color<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> font<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="初始化" tabindex="-1"><a class="header-anchor" href="#初始化" aria-hidden="true">#</a> 初始化</h2><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/downloadPdf&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">downloadPdf</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">DocumentException</span> <span class="token punctuation">{</span>
    <span class="token comment">// 设置响应的内容类型和头部，建议使用PDF的MIME类型</span>
    response<span class="token punctuation">.</span><span class="token function">setContentType</span><span class="token punctuation">(</span><span class="token string">&quot;application/pdf&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    response<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">&quot;Content-Disposition&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;attachment; filename=hello-pdf.pdf&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">Document</span> document <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Document</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">PdfWriter</span> writer <span class="token operator">=</span> <span class="token class-name">PdfWriter</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span>document<span class="token punctuation">,</span> response<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    document<span class="token punctuation">.</span><span class="token keyword">open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 使用itext-asian库中的中文字体</span>
    <span class="token class-name">BaseFont</span> bf <span class="token operator">=</span> <span class="token class-name">BaseFont</span><span class="token punctuation">.</span><span class="token function">createFont</span><span class="token punctuation">(</span><span class="token string">&quot;STSong-Light&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;UniGB-UCS2-H&quot;</span><span class="token punctuation">,</span> <span class="token class-name">BaseFont</span><span class="token punctuation">.</span><span class="token constant">NOT_EMBEDDED</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Font</span> font <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Font</span><span class="token punctuation">(</span>bf<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token class-name">Font</span><span class="token punctuation">.</span><span class="token constant">NORMAL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//添加要写入的内容</span>
    <span class="token comment">//。。。。。。        </span>

    document<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    writer<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="paragraph" tabindex="-1"><a class="header-anchor" href="#paragraph" aria-hidden="true">#</a> Paragraph</h3><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>    <span class="token comment">// 创建一个段落并添加到文档中</span>
    <span class="token class-name">Paragraph</span> paragraph <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Paragraph</span><span class="token punctuation">(</span><span class="token string">&quot;段落&quot;</span><span class="token punctuation">,</span> font<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//居中</span>
    paragraph<span class="token punctuation">.</span><span class="token function">setAlignment</span><span class="token punctuation">(</span><span class="token class-name">Paragraph</span><span class="token punctuation">.</span><span class="token constant">ALIGN_CENTER</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 添加到doc中      </span>
    document<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>paragraph<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 其他</span>
    <span class="token comment">// 。。。</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="chunk" tabindex="-1"><a class="header-anchor" href="#chunk" aria-hidden="true">#</a> Chunk</h3><blockquote><p>可以用来设置段落的某些文本样式</p></blockquote><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">// 创建段落</span>
    <span class="token class-name">Paragraph</span> paragraph <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Paragraph</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 创建一个普通的Chunk</span>
    <span class="token class-name">Chunk</span> simpleChunk <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Chunk</span><span class="token punctuation">(</span><span class="token string">&quot;这是普通的文本。&quot;</span><span class="token punctuation">,</span> font<span class="token punctuation">)</span><span class="token punctuation">;</span>
    paragraph<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>simpleChunk<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 创建一个带超链接的Chunk</span>
    <span class="token class-name">Chunk</span> linkChunk <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Chunk</span><span class="token punctuation">(</span><span class="token string">&quot;点击这里访问iText官网&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Font</span><span class="token punctuation">(</span>bf<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token class-name">Font</span><span class="token punctuation">.</span><span class="token constant">NORMAL</span><span class="token punctuation">,</span> <span class="token class-name">BaseColor</span><span class="token punctuation">.</span><span class="token constant">RED</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    linkChunk<span class="token punctuation">.</span><span class="token function">setAnchor</span><span class="token punctuation">(</span><span class="token string">&quot;http://itextpdf.com/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    paragraph<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>linkChunk<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 创建带颜色的Chunk</span>
    <span class="token class-name">Chunk</span> coloredChunk <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Chunk</span><span class="token punctuation">(</span><span class="token string">&quot;这是彩色的文本。&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Font</span><span class="token punctuation">(</span>bf<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token class-name">Font</span><span class="token punctuation">.</span><span class="token constant">NORMAL</span><span class="token punctuation">,</span> <span class="token class-name">BaseColor</span><span class="token punctuation">.</span><span class="token constant">RED</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    paragraph<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>coloredChunk<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 创建带下划线的Chunk</span>
    <span class="token class-name">Chunk</span> underlineChunk <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Chunk</span><span class="token punctuation">(</span><span class="token string">&quot;这是带下划线的文本。&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Font</span><span class="token punctuation">(</span>bf<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token class-name">Font</span><span class="token punctuation">.</span><span class="token constant">UNDERLINE</span><span class="token punctuation">,</span> <span class="token class-name">BaseColor</span><span class="token punctuation">.</span><span class="token constant">BLACK</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    paragraph<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>underlineChunk<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 创建带删除线的Chunk</span>
    <span class="token class-name">Chunk</span> strikeChunk <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Chunk</span><span class="token punctuation">(</span><span class="token string">&quot;这是带删除线的文本。&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Font</span><span class="token punctuation">(</span>bf<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token class-name">Font</span><span class="token punctuation">.</span><span class="token constant">STRIKETHRU</span><span class="token punctuation">,</span> <span class="token class-name">BaseColor</span><span class="token punctuation">.</span><span class="token constant">BLACK</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    paragraph<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>strikeChunk<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 创建斜体Chunk</span>
    <span class="token class-name">Chunk</span> italicChunk <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Chunk</span><span class="token punctuation">(</span><span class="token string">&quot;这是斜体文本。&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Font</span><span class="token punctuation">(</span>bf<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token class-name">Font</span><span class="token punctuation">.</span><span class="token constant">ITALIC</span><span class="token punctuation">,</span> <span class="token class-name">BaseColor</span><span class="token punctuation">.</span><span class="token constant">BLACK</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    paragraph<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>italicChunk<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 创建粗体Chunk</span>
    <span class="token class-name">Chunk</span> boldChunk <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Chunk</span><span class="token punctuation">(</span><span class="token string">&quot;这是粗体文本。&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Font</span><span class="token punctuation">(</span>bf<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token class-name">Font</span><span class="token punctuation">.</span><span class="token constant">BOLD</span><span class="token punctuation">,</span> <span class="token class-name">BaseColor</span><span class="token punctuation">.</span><span class="token constant">BLACK</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    paragraph<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>boldChunk<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 创建上标Chunk</span>
    <span class="token class-name">Chunk</span> superscriptChunk <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Chunk</span><span class="token punctuation">(</span><span class="token string">&quot;2&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Font</span><span class="token punctuation">(</span>bf<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token class-name">Font</span><span class="token punctuation">.</span><span class="token constant">NORMAL</span><span class="token punctuation">,</span> <span class="token class-name">BaseColor</span><span class="token punctuation">.</span><span class="token constant">BLACK</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    superscriptChunk<span class="token punctuation">.</span><span class="token function">setTextRise</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 设置文本上移</span>
    paragraph<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>superscriptChunk<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 创建下标Chunk</span>
    <span class="token class-name">Chunk</span> subscriptChunk <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Chunk</span><span class="token punctuation">(</span><span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Font</span><span class="token punctuation">(</span>bf<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token class-name">Font</span><span class="token punctuation">.</span><span class="token constant">NORMAL</span><span class="token punctuation">,</span> <span class="token class-name">BaseColor</span><span class="token punctuation">.</span><span class="token constant">BLACK</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    subscriptChunk<span class="token punctuation">.</span><span class="token function">setTextRise</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 设置文本下移</span>
    paragraph<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>subscriptChunk<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 将段落添加到文档中</span>
    document<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>paragraph<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="table" tabindex="-1"><a class="header-anchor" href="#table" aria-hidden="true">#</a> Table</h3><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">// 创建PdfPTable对象，这里创建一个3列的表格</span>
    <span class="token class-name">PdfPTable</span> table <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PdfPTable</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">// 设置表格宽度百分比</span>
    table<span class="token punctuation">.</span><span class="token function">setWidthPercentage</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 设置表格的列宽比例</span>
    <span class="token keyword">float</span><span class="token punctuation">[</span><span class="token punctuation">]</span> columnWidths <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">1f</span><span class="token punctuation">,</span> <span class="token number">2f</span><span class="token punctuation">,</span> <span class="token number">1f</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    table<span class="token punctuation">.</span><span class="token function">setWidths</span><span class="token punctuation">(</span>columnWidths<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 添加单元格到表格</span>
    <span class="token class-name">PdfPCell</span> cell<span class="token punctuation">;</span>


<span class="token comment">// 添加一行数据</span>
    cell <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PdfPCell</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Phrase</span><span class="token punctuation">(</span><span class="token string">&quot;列1&quot;</span><span class="token punctuation">,</span>font<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cell<span class="token punctuation">.</span><span class="token function">setHorizontalAlignment</span><span class="token punctuation">(</span><span class="token class-name">Element</span><span class="token punctuation">.</span><span class="token constant">ALIGN_CENTER</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cell<span class="token punctuation">.</span><span class="token function">setBorder</span><span class="token punctuation">(</span><span class="token class-name">PdfPCell</span><span class="token punctuation">.</span><span class="token constant">NO_BORDER</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 设置单元格内部没有边框</span>
    table<span class="token punctuation">.</span><span class="token function">addCell</span><span class="token punctuation">(</span>cell<span class="token punctuation">)</span><span class="token punctuation">;</span>
    cell <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PdfPCell</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Phrase</span><span class="token punctuation">(</span><span class="token string">&quot;列2&quot;</span><span class="token punctuation">,</span>font<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cell<span class="token punctuation">.</span><span class="token function">setHorizontalAlignment</span><span class="token punctuation">(</span><span class="token class-name">Element</span><span class="token punctuation">.</span><span class="token constant">ALIGN_CENTER</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cell<span class="token punctuation">.</span><span class="token function">setBorder</span><span class="token punctuation">(</span><span class="token class-name">PdfPCell</span><span class="token punctuation">.</span><span class="token constant">NO_BORDER</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 设置单元格内部没有边框</span>
    table<span class="token punctuation">.</span><span class="token function">addCell</span><span class="token punctuation">(</span>cell<span class="token punctuation">)</span><span class="token punctuation">;</span>
    cell <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PdfPCell</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Phrase</span><span class="token punctuation">(</span><span class="token string">&quot;列3&quot;</span><span class="token punctuation">,</span>font<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cell<span class="token punctuation">.</span><span class="token function">setHorizontalAlignment</span><span class="token punctuation">(</span><span class="token class-name">Element</span><span class="token punctuation">.</span><span class="token constant">ALIGN_CENTER</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cell<span class="token punctuation">.</span><span class="token function">setBorder</span><span class="token punctuation">(</span><span class="token class-name">PdfPCell</span><span class="token punctuation">.</span><span class="token constant">NO_BORDER</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 设置单元格内部没有边框</span>
    <span class="token comment">//        行高</span>
    cell<span class="token punctuation">.</span><span class="token function">setFixedHeight</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    table<span class="token punctuation">.</span><span class="token function">addCell</span><span class="token punctuation">(</span>cell<span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">// 继续添加更多行数据</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        table<span class="token punctuation">.</span><span class="token function">addCell</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Paragraph</span><span class="token punctuation">(</span><span class="token string">&quot;行 &quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; 列 1&quot;</span><span class="token punctuation">,</span>font<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        table<span class="token punctuation">.</span><span class="token function">addCell</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Paragraph</span><span class="token punctuation">(</span><span class="token string">&quot;行 &quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; 列 2&quot;</span><span class="token punctuation">,</span>font<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        table<span class="token punctuation">.</span><span class="token function">addCell</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Paragraph</span><span class="token punctuation">(</span><span class="token string">&quot;行 &quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; 列 3&quot;</span><span class="token punctuation">,</span>font<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token comment">// 设置表格的样式</span>
    table<span class="token punctuation">.</span><span class="token function">setSpacingBefore</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 设置表格前间距</span>
    table<span class="token punctuation">.</span><span class="token function">setSpacingAfter</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 设置表格后间距</span>

<span class="token comment">// 将表格添加到文档中</span>
    document<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>table<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="image" tabindex="-1"><a class="header-anchor" href="#image" aria-hidden="true">#</a> Image</h3><blockquote><p>图片</p></blockquote><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>    <span class="token class-name">String</span> url <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
    <span class="token class-name">Image</span> image <span class="token operator">=</span> <span class="token class-name">Image</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//位置</span>
    image<span class="token punctuation">.</span><span class="token function">setAbsolutePosition</span><span class="token punctuation">(</span><span class="token number">380f</span><span class="token punctuation">,</span><span class="token number">460f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//设置图片相对大小</span>
    image<span class="token punctuation">.</span><span class="token function">scaleAbsolute</span><span class="token punctuation">(</span><span class="token number">90f</span><span class="token punctuation">,</span> <span class="token number">120f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//放入图片带文档中</span>
    document<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>image<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="rectangle" tabindex="-1"><a class="header-anchor" href="#rectangle" aria-hidden="true">#</a> Rectangle</h3><blockquote><p>绘制图案</p></blockquote><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>    <span class="token class-name">Rectangle</span> rect <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Rectangle</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">PdfContentByte</span> canvas <span class="token operator">=</span> writer<span class="token punctuation">.</span><span class="token function">getDirectContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    canvas<span class="token punctuation">.</span><span class="token function">saveState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    canvas<span class="token punctuation">.</span><span class="token function">setColorStroke</span><span class="token punctuation">(</span><span class="token class-name">BaseColor</span><span class="token punctuation">.</span><span class="token constant">BLACK</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    canvas<span class="token punctuation">.</span><span class="token function">rectangle</span><span class="token punctuation">(</span>rect<span class="token punctuation">.</span><span class="token function">getLeft</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rect<span class="token punctuation">.</span><span class="token function">getBottom</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rect<span class="token punctuation">.</span><span class="token function">getRight</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rect<span class="token punctuation">.</span><span class="token function">getTop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    canvas<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    canvas<span class="token punctuation">.</span><span class="token function">restoreState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,19);function v(b,g){const a=e("ExternalLinkIcon");return o(),c("div",null,[i,n("p",null,[n("a",k,[s("IText7使用（超详解） - 明小子@ - 博客园 (cnblogs.com)"),t(a)])]),n("p",null,[n("a",r,[s("关于HTML页面转pdf的一点经验_使用 htmlworker 解析html为pdf-CSDN博客"),t(a)])]),n("p",null,[n("a",d,[s("itext5 html转pdf-CSDN博客"),t(a)])]),m])}const w=p(u,[["render",v],["__file","pdf.html.vue"]]);export{w as default};
