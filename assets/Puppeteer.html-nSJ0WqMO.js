import{_ as i,c as a,a as e,o as n}from"./app-BJNIPHqW.js";const l={};function t(h,s){return n(),a("div",null,s[0]||(s[0]=[e(`<h1 id="puppeteer" tabindex="-1"><a class="header-anchor" href="#puppeteer"><span>Puppeteer</span></a></h1><h6 id="api-faq-contributing-troubleshooting" tabindex="-1"><a class="header-anchor" href="#api-faq-contributing-troubleshooting"><span><a href="https://github.com/GoogleChrome/puppeteer/blob/v1.10.0/docs/api.md" target="_blank" rel="noopener noreferrer">API</a> | <a href="https://puppeteer.bootcss.com/#faq" target="_blank" rel="noopener noreferrer">FAQ</a> | <a href="https://github.com/GoogleChrome/puppeteer/blob/master/CONTRIBUTING.md" target="_blank" rel="noopener noreferrer">Contributing</a> | <a href="https://github.com/GoogleChrome/puppeteer/blob/master/docs/troubleshooting.md" target="_blank" rel="noopener noreferrer">Troubleshooting</a></span></a></h6><blockquote><p>Puppeteer 是一个 Node 库，它提供了一个高级 API 来通过 <a href="https://chromedevtools.github.io/devtools-protocol/" target="_blank" rel="noopener noreferrer">DevTools</a> 协议控制 Chromium 或 Chrome。Puppeteer 默认以 <a href="https://developers.google.com/web/updates/2017/04/headless-chrome" target="_blank" rel="noopener noreferrer">headless</a> 模式运行，但是可以通过修改配置文件运行“有头”模式。</p></blockquote><h6 id="能做什么" tabindex="-1"><a class="header-anchor" href="#能做什么"><span>能做什么?</span></a></h6><p>你可以在浏览器中手动执行的绝大多数操作都可以使用 Puppeteer 来完成！ 下面是一些示例：</p><ul><li>生成页面 PDF。</li><li>抓取 SPA（单页应用）并生成预渲染内容（即“SSR”（服务器端渲染））。</li><li>自动提交表单，进行 UI 测试，键盘输入等。</li><li>创建一个时时更新的自动化测试环境。 使用最新的 JavaScript 和浏览器功能直接在最新版本的Chrome中执行测试。</li><li>捕获网站的 <a href="https://developers.google.com/web/tools/chrome-devtools/evaluate-performance/reference" target="_blank" rel="noopener noreferrer">timeline trace</a>，用来帮助分析性能问题。</li><li>测试浏览器扩展。</li></ul><p>演示地址: <a href="https://try-puppeteer.appspot.com/" target="_blank" rel="noopener noreferrer">https://try-puppeteer.appspot.com/</a></p><h2 id="开始使用" tabindex="-1"><a class="header-anchor" href="#开始使用"><span>开始使用</span></a></h2><h3 id="安装" tabindex="-1"><a class="header-anchor" href="#安装"><span>安装</span></a></h3><p>在项目中使用 Puppeteer：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#e1e4e8;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#24292e;"><pre class="shiki shiki-themes one-light github-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#B392F0;">npm</span><span style="--shiki-light:#50A14F;--shiki-dark:#9ECBFF;"> i</span><span style="--shiki-light:#50A14F;--shiki-dark:#9ECBFF;"> puppeteer</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#6A737D;--shiki-dark-font-style:inherit;"># or &quot;yarn add puppeteer&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>Note: 当你安装 Puppeteer 时，它会下载最新版本的Chromium（~170MB Mac，~282MB Linux，~280MB Win），以保证可以使用 API。 如果想要跳过下载，请阅读<a href="https://github.com/GoogleChrome/puppeteer/blob/v1.10.0/docs/api.md#environment-variables" target="_blank" rel="noopener noreferrer">环境变量</a>。</p><h3 id="puppeteer-core" tabindex="-1"><a class="header-anchor" href="#puppeteer-core"><span>puppeteer-core</span></a></h3><p>自 1.7.0 版本以来，我们都会发布一个 <a href="https://www.npmjs.com/package/puppeteer-core" target="_blank" rel="noopener noreferrer"><code>puppeteer-core</code></a> 包，这个包默认不会下载 Chromium。</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#e1e4e8;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#24292e;"><pre class="shiki shiki-themes one-light github-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#B392F0;">npm</span><span style="--shiki-light:#50A14F;--shiki-dark:#9ECBFF;"> i</span><span style="--shiki-light:#50A14F;--shiki-dark:#9ECBFF;"> puppeteer-core</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#6A737D;--shiki-dark-font-style:inherit;"># or &quot;yarn add puppeteer-core&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><code>puppeteer-core</code> 是一个的轻量级的 Puppeteer 版本，用于启动现有浏览器安装或连接到远程安装。</p><p>具体见 <a href="https://github.com/GoogleChrome/puppeteer/blob/master/docs/api.md#puppeteer-vs-puppeteer-core" target="_blank" rel="noopener noreferrer">puppeteer vs puppeteer-core</a>.</p><h3 id="使用" tabindex="-1"><a class="header-anchor" href="#使用"><span>使用</span></a></h3><p>Note: Puppeteer 至少需要 Node v6.4.0，下面的示例使用 async / await，它们仅在 Node v7.6.0 或更高版本中被支持。</p><p>Puppeteer 使用起来和其他测试框架类似。你需要创建一个 <code>Browser</code> 实例，打开页面，然后使用 <a href="https://github.com/GoogleChrome/puppeteer/blob/v1.10.0/docs/api.md#" target="_blank" rel="noopener noreferrer">Puppeteer 的 API</a>。</p><p><strong>Example</strong> - 跳转到 <a href="https://example.com/" target="_blank" rel="noopener noreferrer">https://example.com</a> 并保存截图至 <em>example.png</em>:</p><p>文件为 <strong>example.js</strong></p><div class="language-js line-numbers-mode" data-highlighter="shiki" data-ext="js" style="--shiki-light:#383A42;--shiki-dark:#e1e4e8;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#24292e;"><pre class="shiki shiki-themes one-light github-dark vp-code"><code class="language-js"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#986801;--shiki-dark:#79B8FF;"> puppeteer</span><span style="--shiki-light:#0184BC;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#4078F2;--shiki-dark:#B392F0;"> require</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#9ECBFF;">&#39;puppeteer&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;"> () </span><span style="--shiki-light:#A626A4;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#986801;--shiki-dark:#79B8FF;"> browser</span><span style="--shiki-light:#0184BC;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#A626A4;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;"> puppeteer.</span><span style="--shiki-light:#4078F2;--shiki-dark:#B392F0;">launch</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#986801;--shiki-dark:#79B8FF;"> page</span><span style="--shiki-light:#0184BC;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#A626A4;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;"> browser.</span><span style="--shiki-light:#4078F2;--shiki-dark:#B392F0;">newPage</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#F97583;">  await</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;"> page.</span><span style="--shiki-light:#4078F2;--shiki-dark:#B392F0;">goto</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#9ECBFF;">&#39;https://example.com&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#F97583;">  await</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;"> page.</span><span style="--shiki-light:#4078F2;--shiki-dark:#B392F0;">screenshot</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">({</span><span style="--shiki-light:#E45649;--shiki-dark:#E1E4E8;">path</span><span style="--shiki-light:#0184BC;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#9ECBFF;"> &#39;example.png&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#F97583;">  await</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;"> browser.</span><span style="--shiki-light:#4078F2;--shiki-dark:#B392F0;">close</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">})();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在命令行中执行</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#e1e4e8;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#24292e;"><pre class="shiki shiki-themes one-light github-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#B392F0;">node</span><span style="--shiki-light:#50A14F;--shiki-dark:#9ECBFF;"> example.js</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Puppeteer 初始化的屏幕大小默认为 800px x 600px。但是这个尺寸可以通过 <a href="https://github.com/GoogleChrome/puppeteer/blob/v1.10.0/docs/api.md#pagesetviewportviewport" target="_blank" rel="noopener noreferrer"><code>Page.setViewport()</code></a> 设置。</p><p><strong>Example</strong> - 创建一个 PDF。</p><p>文件为 <strong>hn.js</strong></p><div class="language-js line-numbers-mode" data-highlighter="shiki" data-ext="js" style="--shiki-light:#383A42;--shiki-dark:#e1e4e8;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#24292e;"><pre class="shiki shiki-themes one-light github-dark vp-code"><code class="language-js"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#986801;--shiki-dark:#79B8FF;"> puppeteer</span><span style="--shiki-light:#0184BC;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#4078F2;--shiki-dark:#B392F0;"> require</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#9ECBFF;">&#39;puppeteer&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;"> () </span><span style="--shiki-light:#A626A4;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#986801;--shiki-dark:#79B8FF;"> browser</span><span style="--shiki-light:#0184BC;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#A626A4;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;"> puppeteer.</span><span style="--shiki-light:#4078F2;--shiki-dark:#B392F0;">launch</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#986801;--shiki-dark:#79B8FF;"> page</span><span style="--shiki-light:#0184BC;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#A626A4;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;"> browser.</span><span style="--shiki-light:#4078F2;--shiki-dark:#B392F0;">newPage</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#F97583;">  await</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;"> page.</span><span style="--shiki-light:#4078F2;--shiki-dark:#B392F0;">goto</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#9ECBFF;">&#39;https://news.ycombinator.com&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">, {</span><span style="--shiki-light:#E45649;--shiki-dark:#E1E4E8;">waitUntil</span><span style="--shiki-light:#0184BC;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#9ECBFF;"> &#39;networkidle2&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">});</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#F97583;">  await</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;"> page.</span><span style="--shiki-light:#4078F2;--shiki-dark:#B392F0;">pdf</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">({</span><span style="--shiki-light:#E45649;--shiki-dark:#E1E4E8;">path</span><span style="--shiki-light:#0184BC;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#9ECBFF;"> &#39;hn.pdf&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E45649;--shiki-dark:#E1E4E8;">format</span><span style="--shiki-light:#0184BC;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#9ECBFF;"> &#39;A4&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#F97583;">  await</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;"> browser.</span><span style="--shiki-light:#4078F2;--shiki-dark:#B392F0;">close</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">})();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在命令行中执行</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#e1e4e8;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#24292e;"><pre class="shiki shiki-themes one-light github-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#B392F0;">node</span><span style="--shiki-light:#50A14F;--shiki-dark:#9ECBFF;"> hn.js</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>查看 <a href="https://github.com/GoogleChrome/puppeteer/blob/v1.10.0/docs/api.md#pagepdfoptions" target="_blank" rel="noopener noreferrer"><code>Page.pdf()</code></a> 了解跟多内容。</p><p><strong>Example</strong> - 在页面中执行脚本</p><p>文件为 <strong>get-dimensions.js</strong></p><div class="language-js line-numbers-mode has-collapsed-lines collapsed" data-highlighter="shiki" data-ext="js" style="--vp-collapsed-lines:15;--shiki-light:#383A42;--shiki-dark:#e1e4e8;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#24292e;"><pre class="shiki shiki-themes one-light github-dark vp-code"><code class="language-js"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#986801;--shiki-dark:#79B8FF;"> puppeteer</span><span style="--shiki-light:#0184BC;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#4078F2;--shiki-dark:#B392F0;"> require</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#9ECBFF;">&#39;puppeteer&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;"> () </span><span style="--shiki-light:#A626A4;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#986801;--shiki-dark:#79B8FF;"> browser</span><span style="--shiki-light:#0184BC;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#A626A4;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;"> puppeteer.</span><span style="--shiki-light:#4078F2;--shiki-dark:#B392F0;">launch</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#986801;--shiki-dark:#79B8FF;"> page</span><span style="--shiki-light:#0184BC;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#A626A4;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;"> browser.</span><span style="--shiki-light:#4078F2;--shiki-dark:#B392F0;">newPage</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#F97583;">  await</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;"> page.</span><span style="--shiki-light:#4078F2;--shiki-dark:#B392F0;">goto</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#9ECBFF;">&#39;https://example.com&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#6A737D;--shiki-dark-font-style:inherit;">  // Get the &quot;viewport&quot; of the page, as reported by the page.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#986801;--shiki-dark:#79B8FF;"> dimensions</span><span style="--shiki-light:#0184BC;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#A626A4;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;"> page.</span><span style="--shiki-light:#4078F2;--shiki-dark:#B392F0;">evaluate</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#A626A4;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E1E4E8;">      width</span><span style="--shiki-light:#0184BC;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;"> document.</span><span style="--shiki-light:#E45649;--shiki-dark:#E1E4E8;">documentElement</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E1E4E8;">clientWidth</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E1E4E8;">      height</span><span style="--shiki-light:#0184BC;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;"> document.</span><span style="--shiki-light:#E45649;--shiki-dark:#E1E4E8;">documentElement</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E1E4E8;">clientHeight</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E1E4E8;">      deviceScaleFactor</span><span style="--shiki-light:#0184BC;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;"> window.</span><span style="--shiki-light:#E45649;--shiki-dark:#E1E4E8;">devicePixelRatio</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">    };</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">  });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">  console.</span><span style="--shiki-light:#4078F2;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#9ECBFF;">&#39;Dimensions:&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">, dimensions);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#F97583;">  await</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;"> browser.</span><span style="--shiki-light:#4078F2;--shiki-dark:#B392F0;">close</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">})();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="collapsed-lines"></div></div><p>在命令行中执行</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#e1e4e8;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#24292e;"><pre class="shiki shiki-themes one-light github-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#B392F0;">node</span><span style="--shiki-light:#50A14F;--shiki-dark:#9ECBFF;"> get-dimensions.js</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>查看 <a href="https://github.com/GoogleChrome/puppeteer/blob/v1.10.0/docs/api.md#pageevaluatepagefunction-args" target="_blank" rel="noopener noreferrer"><code>Page.evaluate()</code></a> 了解更多相关内容，该方法有点类似于 <code>evaluateOnNewDocument</code> and <code>exposeFunction</code>。</p><h2 id="默认设置" tabindex="-1"><a class="header-anchor" href="#默认设置"><span>默认设置</span></a></h2><p><strong>1. 使用无头模式</strong></p><p>Puppeteer 运行 Chromium 的<a href="https://developers.google.com/web/updates/2017/04/headless-chrome" target="_blank" rel="noopener noreferrer">headless mode</a>。如果想要使用完全版本的 Chromium，设置 <a href="https://github.com/GoogleChrome/puppeteer/blob/v1.10.0/docs/api.md#puppeteerlaunchoptions" target="_blank" rel="noopener noreferrer">&#39;headless&#39; option</a> 即可。</p><div class="language-js line-numbers-mode" data-highlighter="shiki" data-ext="js" style="--shiki-light:#383A42;--shiki-dark:#e1e4e8;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#24292e;"><pre class="shiki shiki-themes one-light github-dark vp-code"><code class="language-js"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#986801;--shiki-dark:#79B8FF;"> browser</span><span style="--shiki-light:#0184BC;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#A626A4;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;"> puppeteer.</span><span style="--shiki-light:#4078F2;--shiki-dark:#B392F0;">launch</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">({</span><span style="--shiki-light:#E45649;--shiki-dark:#E1E4E8;">headless</span><span style="--shiki-light:#0184BC;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#986801;--shiki-dark:#79B8FF;"> false</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">}); </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#6A737D;--shiki-dark-font-style:inherit;">// default is true</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>2. 运行绑定的 Chromium 版本</strong></p><p>默认情况下，Puppeteer 下载并使用特定版本的 Chromium 以及其 API 保证开箱即用。 如果要将 Puppeteer 与不同版本的 Chrome 或 Chromium 一起使用，在创建<code>Browser</code>实例时传入 Chromium 可执行文件的路径即可：</p><div class="language-js line-numbers-mode" data-highlighter="shiki" data-ext="js" style="--shiki-light:#383A42;--shiki-dark:#e1e4e8;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#24292e;"><pre class="shiki shiki-themes one-light github-dark vp-code"><code class="language-js"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#986801;--shiki-dark:#79B8FF;"> browser</span><span style="--shiki-light:#0184BC;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#A626A4;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;"> puppeteer.</span><span style="--shiki-light:#4078F2;--shiki-dark:#B392F0;">launch</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">({</span><span style="--shiki-light:#E45649;--shiki-dark:#E1E4E8;">executablePath</span><span style="--shiki-light:#0184BC;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#9ECBFF;"> &#39;/path/to/Chrome&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>具体见：<a href="https://github.com/GoogleChrome/puppeteer/blob/v1.10.0/docs/api.md#puppeteerlaunchoptions" target="_blank" rel="noopener noreferrer"><code>Puppeteer.launch()</code></a></p><p>看<a href="https://www.howtogeek.com/202825/what%E2%80%99s-the-difference-between-chromium-and-chrome/" target="_blank" rel="noopener noreferrer"><code>这篇文章</code></a>了解 Chromium 与 Chrome 的不同。<a href="https://chromium.googlesource.com/chromium/src/+/master/docs/chromium_browser_vs_google_chrome.md" target="_blank" rel="noopener noreferrer"><code>这篇文章</code></a> 介绍了一些 Linux 用户在使用上的区别。</p><p><strong>3. 创建用户配置文件</strong></p><p>Puppeteer 会创建自己的 Chromium 用户配置文件，<strong>它会在每次运行时清理</strong>。</p><h2 id="模板" tabindex="-1"><a class="header-anchor" href="#模板"><span>模板</span></a></h2><div class="language-js line-numbers-mode has-collapsed-lines collapsed" data-highlighter="shiki" data-ext="js" style="--vp-collapsed-lines:15;--shiki-light:#383A42;--shiki-dark:#e1e4e8;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#24292e;"><pre class="shiki shiki-themes one-light github-dark vp-code"><code class="language-js"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#986801;--shiki-dark:#79B8FF;"> puppeteer</span><span style="--shiki-light:#0184BC;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#4078F2;--shiki-dark:#B392F0;"> require</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#9ECBFF;">&#39;puppeteer&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#986801;--shiki-dark:#79B8FF;"> path</span><span style="--shiki-light:#0184BC;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#4078F2;--shiki-dark:#B392F0;"> require</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#9ECBFF;">&#39;path&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#A626A4;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#4078F2;--shiki-dark:#B392F0;"> captureScreenshot</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#986801;--shiki-dark:#79B8FF;"> browser</span><span style="--shiki-light:#0184BC;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#A626A4;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;"> puppeteer.</span><span style="--shiki-light:#4078F2;--shiki-dark:#B392F0;">launch</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">({ </span><span style="--shiki-light:#E45649;--shiki-dark:#E1E4E8;">args</span><span style="--shiki-light:#0184BC;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#50A14F;--shiki-dark:#9ECBFF;">&#39;--no-sandbox&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#9ECBFF;">&#39;--disable-setuid-sandbox&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">] })</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#986801;--shiki-dark:#79B8FF;"> page</span><span style="--shiki-light:#0184BC;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#A626A4;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;"> browser.</span><span style="--shiki-light:#4078F2;--shiki-dark:#B392F0;">newPage</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#F97583;">  await</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;"> page.</span><span style="--shiki-light:#4078F2;--shiki-dark:#B392F0;">setViewport</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">({ </span><span style="--shiki-light:#E45649;--shiki-dark:#E1E4E8;">width</span><span style="--shiki-light:#0184BC;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#986801;--shiki-dark:#79B8FF;"> 1920</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E45649;--shiki-dark:#E1E4E8;">height</span><span style="--shiki-light:#0184BC;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#986801;--shiki-dark:#79B8FF;"> 1080</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;"> }); </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#6A737D;--shiki-dark-font-style:inherit;">// 根据需要设置宽度和高度</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#F97583;">  await</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;"> page.</span><span style="--shiki-light:#4078F2;--shiki-dark:#B392F0;">goto</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#9ECBFF;">&#39;http://xxxxxxx.com/&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">); </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#6A737D;--shiki-dark-font-style:inherit;">// 替换成你的网站地址</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#6A737D;--shiki-dark-font-style:inherit;">  // 获取当前日期</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#986801;--shiki-dark:#79B8FF;"> currentDate</span><span style="--shiki-light:#0184BC;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#A626A4;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#B392F0;"> Date</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#986801;--shiki-dark:#79B8FF;"> formattedDate</span><span style="--shiki-light:#0184BC;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;"> currentDate.</span><span style="--shiki-light:#4078F2;--shiki-dark:#B392F0;">toISOString</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">().</span><span style="--shiki-light:#4078F2;--shiki-dark:#B392F0;">slice</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#986801;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#986801;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">); </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#6A737D;--shiki-dark-font-style:inherit;">// 格式化日期为 yyyy-MM-dd</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#6A737D;--shiki-dark-font-style:inherit;">  // 生成截图文件路径和名称</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#986801;--shiki-dark:#79B8FF;"> screenshotPath</span><span style="--shiki-light:#0184BC;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;"> path.</span><span style="--shiki-light:#4078F2;--shiki-dark:#B392F0;">join</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">(__dirname, </span><span style="--shiki-light:#50A14F;--shiki-dark:#9ECBFF;">\`</span><span style="--shiki-light:#CA1243;--shiki-dark:#9ECBFF;">\${</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">formattedDate</span><span style="--shiki-light:#CA1243;--shiki-dark:#9ECBFF;">}</span><span style="--shiki-light:#50A14F;--shiki-dark:#9ECBFF;">.png\`</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#6A737D;--shiki-dark-font-style:inherit;">  // 设置截图选项</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#986801;--shiki-dark:#79B8FF;"> screenshotOptions</span><span style="--shiki-light:#0184BC;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E1E4E8;">    path</span><span style="--shiki-light:#0184BC;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;"> screenshotPath, </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#6A737D;--shiki-dark-font-style:inherit;">// 保存截图的文件路径和名称</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E1E4E8;">    fullPage</span><span style="--shiki-light:#0184BC;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#986801;--shiki-dark:#79B8FF;"> false</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#6A737D;--shiki-dark-font-style:inherit;">// 截取整个页面</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E1E4E8;">    clip</span><span style="--shiki-light:#0184BC;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#E45649;--shiki-dark:#E1E4E8;">x</span><span style="--shiki-light:#0184BC;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#986801;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E45649;--shiki-dark:#E1E4E8;">y</span><span style="--shiki-light:#0184BC;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#986801;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E45649;--shiki-dark:#E1E4E8;">width</span><span style="--shiki-light:#0184BC;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#986801;--shiki-dark:#79B8FF;"> 1920</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E45649;--shiki-dark:#E1E4E8;">height</span><span style="--shiki-light:#0184BC;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#986801;--shiki-dark:#79B8FF;"> 1080</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;"> }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">  };</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#F97583;">  await</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;"> page.</span><span style="--shiki-light:#4078F2;--shiki-dark:#B392F0;">screenshot</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">(screenshotOptions);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#F97583;">  await</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;"> browser.</span><span style="--shiki-light:#4078F2;--shiki-dark:#B392F0;">close</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#B392F0;">captureScreenshot</span><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#6A737D;--shiki-dark-font-style:inherit;">// //可以使用</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#6A737D;--shiki-dark-font-style:inherit;">// const puppeteer = require(&#39;puppeteer&#39;);</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#6A737D;--shiki-dark-font-style:inherit;">// const path = require(&#39;path&#39;);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#6A737D;--shiki-dark-font-style:inherit;">// async function captureScreenshot() {</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#6A737D;--shiki-dark-font-style:inherit;">//   const browser = await puppeteer.launch();</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#6A737D;--shiki-dark-font-style:inherit;">//   const page = await browser.newPage();</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#6A737D;--shiki-dark-font-style:inherit;">//   await page.goto(&#39;https://beink.cn&#39;); // 替换成你的网站地址</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#6A737D;--shiki-dark-font-style:inherit;">//     // 获取当前日期</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#6A737D;--shiki-dark-font-style:inherit;">//   const currentDate = new Date();</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#6A737D;--shiki-dark-font-style:inherit;">//   const formattedDate = currentDate.toISOString().slice(0, 10); // 格式化日期为 yyyy-MM-dd</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#6A737D;--shiki-dark-font-style:inherit;">//   // 生成截图文件路径和名称</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#6A737D;--shiki-dark-font-style:inherit;">//   const screenshotPath = path.join(__dirname, \`\${formattedDate}.png\`);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#6A737D;--shiki-dark-font-style:inherit;">//   await page.screenshot({ path: screenshotPath }); // 保存截图的文件路径和名称</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#6A737D;--shiki-dark-font-style:inherit;">//   await browser.close();</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#6A737D;--shiki-dark-font-style:inherit;">// }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#6A737D;--shiki-dark-font-style:inherit;">// captureScreenshot();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="collapsed-lines"></div></div><blockquote><p>一张图片大概3M</p></blockquote><h2 id="定时" tabindex="-1"><a class="header-anchor" href="#定时"><span>定时</span></a></h2><ul><li>crontab -e</li><li>0 0 12 * * ? cd /www/shot &amp;&amp; node shot.js</li></ul><h2 id="github-action" tabindex="-1"><a class="header-anchor" href="#github-action"><span>Github action</span></a></h2><div class="language- line-numbers-mode has-collapsed-lines collapsed" data-highlighter="shiki" data-ext="" style="--vp-collapsed-lines:15;--shiki-light:#383A42;--shiki-dark:#e1e4e8;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#24292e;"><pre class="shiki shiki-themes one-light github-dark vp-code"><code class="language-"><span class="line"><span>name: main</span></span>
<span class="line"><span></span></span>
<span class="line"><span>on:</span></span>
<span class="line"><span>  push:</span></span>
<span class="line"><span>    branches:</span></span>
<span class="line"><span>      - main</span></span>
<span class="line"><span>  schedule:</span></span>
<span class="line"><span>    - cron: &#39;0 */6 * * *&#39;  # 每6小时执行一次，可根据需要调整时间</span></span>
<span class="line"><span></span></span>
<span class="line"><span>jobs:</span></span>
<span class="line"><span>  run-coupons:</span></span>
<span class="line"><span>    runs-on: ubuntu-latest</span></span>
<span class="line"><span>    steps:</span></span>
<span class="line"><span>      - name: Checkout code</span></span>
<span class="line"><span>        uses: actions/checkout@v2</span></span>
<span class="line"><span>           </span></span>
<span class="line"><span>      - name: Setup Node.js</span></span>
<span class="line"><span>        uses: actions/setup-node@v2</span></span>
<span class="line"><span>        with:</span></span>
<span class="line"><span>          node-version: &#39;18.16.0&#39;</span></span>
<span class="line"><span>          </span></span>
<span class="line"><span>      - name: Install Dependencies</span></span>
<span class="line"><span>        run: |</span></span>
<span class="line"><span>          sudo apt-get install fonts-wqy-zenhei</span></span>
<span class="line"><span>          npm install</span></span>
<span class="line"><span>          npm install puppeteer</span></span>
<span class="line"><span>          </span></span>
<span class="line"><span>      - name: Run Script</span></span>
<span class="line"><span>        run: node shot.js</span></span>
<span class="line"><span></span></span>
<span class="line"><span>      - name: Create Image Branch</span></span>
<span class="line"><span>        run: |</span></span>
<span class="line"><span>          git stash</span></span>
<span class="line"><span>          git fetch origin</span></span>
<span class="line"><span>          git checkout image</span></span>
<span class="line"><span>          mkdir -p image</span></span>
<span class="line"><span>          mv *.png image/</span></span>
<span class="line"><span>          git pull origin image</span></span>
<span class="line"><span>          git config --local user.email &quot;action@github.com&quot;</span></span>
<span class="line"><span>          git config --local user.name &quot;GitHub Action&quot;</span></span>
<span class="line"><span>          git add .</span></span>
<span class="line"><span>          git commit -m &quot;Add downloaded images&quot;</span></span>
<span class="line"><span>          git push origin image</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="collapsed-lines"></div></div><h2 id="问题" tabindex="-1"><a class="header-anchor" href="#问题"><span>问题</span></a></h2><h3 id="puppeteer没有自动安装chromium的解决办法" tabindex="-1"><a class="header-anchor" href="#puppeteer没有自动安装chromium的解决办法"><span>Puppeteer没有自动安装Chromium的解决办法</span></a></h3><p><a href="https://blog.csdn.net/henryhu712/article/details/115588221" target="_blank" rel="noopener noreferrer">Puppeteer没有自动安装Chromium的解决办法_亮子AI的博客-CSDN博客</a><br><a href="https://blog.csdn.net/qq_42414062/article/details/114539378" target="_blank" rel="noopener noreferrer">安装后再看这</a></p><p>按照官方文档的说法，安装 Puppeteer 时会自动安装 Chromium 浏览器。但是实际安装过程中，会出现不安装 Chromium 的情况，这时需要使用下面的命令来手动安装 Chromium：</p><p><code>node node_modules/puppeteer/install.js</code><br> 这样就能把 Chromium 正确的安装到 node_modules/puppeteer/.local-chromium 目录下。根据操作系统及浏览器版本的不同，浏览器大概占用 200M～400M 的磁盘空间。</p>`,61)]))}const r=i(l,[["render",t]]),k=JSON.parse('{"path":"/blog/tools/Puppeteer.html","title":"Puppeteer","lang":"zh-CN","frontmatter":{"title":"Puppeteer","icon":"devicon:puppeteer","order":5,"category":["Tool"],"tag":["Puppeteer"],"description":"Puppeteer API | FAQ | Contributing | Troubleshooting Puppeteer 是一个 Node 库，它提供了一个高级 API 来通过 DevTools 协议控制 Chromium 或 Chrome。Puppeteer 默认以 headless 模式运行，但是可以通过修改配置文件运行“有头”模式。 能做什么...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Puppeteer\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-10-09T01:57:56.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"mishu\\",\\"url\\":\\"https://github.com/ToTryEveryThing/my-docs\\"}]}"],["meta",{"property":"og:url","content":"https://docs.beink.cn/blog/tools/Puppeteer.html"}],["meta",{"property":"og:title","content":"Puppeteer"}],["meta",{"property":"og:description","content":"Puppeteer API | FAQ | Contributing | Troubleshooting Puppeteer 是一个 Node 库，它提供了一个高级 API 来通过 DevTools 协议控制 Chromium 或 Chrome。Puppeteer 默认以 headless 模式运行，但是可以通过修改配置文件运行“有头”模式。 能做什么..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-10-09T01:57:56.000Z"}],["meta",{"property":"article:tag","content":"Puppeteer"}],["meta",{"property":"article:modified_time","content":"2024-10-09T01:57:56.000Z"}]]},"git":{"createdTime":1687865059000,"updatedTime":1728439076000,"contributors":[{"name":"ToTryEveryThing","username":"ToTryEveryThing","email":"849299509@qq.com","commits":6,"url":"https://github.com/ToTryEveryThing"},{"name":"mishu","username":"mishu","email":"riceuncle@outlook.com","commits":13,"url":"https://github.com/mishu"}],"changelog":[{"hash":"6f73239b58fca703dc113ad10ae79d7b8fb6fb92","time":1728439076000,"email":"riceuncle@outlook.com","author":"mishu","message":"icon"},{"hash":"fe88cf5919f7f045543f77d0b3021e6d14a6208c","time":1723793860000,"email":"riceuncle@outlook.com","author":"mishu","message":"seo"},{"hash":"c0c16af9fcda1b2a473c6115ece4587c0176f743","time":1723793860000,"email":"riceuncle@outlook.com","author":"mishu","message":"seo"},{"hash":"ded7f6a012b43f5beb1156f25518fdfa5109bbbd","time":1723186347000,"email":"riceuncle@outlook.com","author":"mishu","message":"seo"},{"hash":"3a085f15eab56f0caebef229080dac502d1b4394","time":1723186347000,"email":"riceuncle@outlook.com","author":"mishu","message":"seo"},{"hash":"4655f3491ddbe1c62d2bdb4a16b2b711163232f7","time":1720747292000,"email":"riceuncle@outlook.com","author":"mishu","message":"update"},{"hash":"a0e4c76b9d7519aa81efbc91171d85a6e0c324ab","time":1720747292000,"email":"riceuncle@outlook.com","author":"mishu","message":"update"},{"hash":"37f63f9446ea0a76a04f2fe484cde9eea4074241","time":1702971377000,"email":"riceuncle@outlook.com","author":"mishu","message":"jasypt"},{"hash":"74ff6f97a18571e0311d09a6acfc5d03d15bdf51","time":1702971377000,"email":"849299509@qq.com","author":"ToTryEveryThing","message":"jasypt"},{"hash":"07f779ada7ecbc9fb3f071cfbebebb90dfab4942","time":1702971377000,"email":"riceuncle@outlook.com","author":"mishu","message":"jasypt"},{"hash":"fafd6ce506caaa4c1eb6e961ae249d50f480294b","time":1702971377000,"email":"849299509@qq.com","author":"ToTryEveryThing","message":"jasypt"},{"hash":"a82a8d756be432a3e66e7c0973fc31b37f1e39d9","time":1687960562000,"email":"riceuncle@outlook.com","author":"mishu","message":"Update <a href=\\"http://Puppeteer.md\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">Puppeteer.md</a>"},{"hash":"f0366b7d5fb8ec163e493c744cec4f4b4fc81e36","time":1687960562000,"email":"79239899+ToTryEveryThing@users.noreply.github.com","author":"mishu","message":"Update <a href=\\"http://Puppeteer.md\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">Puppeteer.md</a>"},{"hash":"d0ba7ed915e3af09aacfd1719bfe3d6de185f428","time":1687960562000,"email":"riceuncle@outlook.com","author":"mishu","message":"Update <a href=\\"http://Puppeteer.md\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">Puppeteer.md</a>"},{"hash":"8807c08b338aeca4924dfd108d768edcc8283ad3","time":1687960562000,"email":"79239899+ToTryEveryThing@users.noreply.github.com","author":"mishu","message":"Update <a href=\\"http://Puppeteer.md\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">Puppeteer.md</a>"},{"hash":"d5cd0f9a0e2959f644d929239492779b3eb82636","time":1687865059000,"email":"riceuncle@outlook.com","author":"mishu","message":"Puppeteer"},{"hash":"a1de807e426aded7415ad8fe75ed920314e4f037","time":1687865059000,"email":"849299509@qq.com","author":"ToTryEveryThing","message":"Puppeteer"},{"hash":"ef6fb159237d8a3cad0aa9a968f24993bc32353e","time":1687865059000,"email":"riceuncle@outlook.com","author":"mishu","message":"Puppeteer"},{"hash":"91273cdc1b3bcfd29de1ab3e3cebd9c60d9ea3a3","time":1687865059000,"email":"849299509@qq.com","author":"ToTryEveryThing","message":"Puppeteer"}]},"readingTime":{"minutes":5,"words":1499},"filePathRelative":"blog/tools/Puppeteer.md","excerpt":"\\n<h6><a class=\\"header-anchor\\" href=\\"#api-faq-contributing-troubleshooting\\"><span></span></a><a href=\\"https://github.com/GoogleChrome/puppeteer/blob/v1.10.0/docs/api.md\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">API</a> | <a href=\\"https://puppeteer.bootcss.com/#faq\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">FAQ</a> | <a href=\\"https://github.com/GoogleChrome/puppeteer/blob/master/CONTRIBUTING.md\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">Contributing</a> | <a href=\\"https://github.com/GoogleChrome/puppeteer/blob/master/docs/troubleshooting.md\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">Troubleshooting</a></h6>","autoDesc":true}');export{r as comp,k as data};
