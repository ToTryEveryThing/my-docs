import{u as I,f as te,g as le,h as _,i as se,P as ae,t as re,j as oe,k as L,l as w,m as ie,n as U,p as l,q as ue,R as F,s as ne,v as ce,x as ge,C as he,y as ve,z as me,A as pe,B as ye,D as de,E as be,F as ke,G as O,H as T,I as fe,J as q,K as Se}from"./app-CDu2_RGC.js";const He=["/","/blog/","/blog/Microservices/ElasticSearch.html","/blog/Microservices/","/blog/Microservices/SpringCloud.html","/blog/Microservices/rabbitmq.html","/blog/Microservices/redis.html","/blog/SSM/Mybatis.html","/blog/SSM/MybatisPlus.html","/blog/SSM/","/blog/SSM/mysql.html","/blog/SSM/quartz.html","/blog/SSM/ssm.html","/blog/itheima/","/blog/markmap/","/blog/markmap/main.html","/blog/other/Git.html","/blog/other/Maven.html","/blog/other/Nginx.html","/blog/other/","/blog/other/alioss.html","/blog/other/book.html","/blog/other/linux.html","/blog/tools/Jenkins.html","/blog/tools/Puppeteer.html","/blog/tools/","/blog/tools/action.html","/blog/tools/cron.html","/blog/tools/jasypt.html","/blog/tools/regex.html","/blog/worklogs/","/blog/worklogs/mysql.html","/blog/worklogs/pdf.html","/blog/worklogs/principle.html","/blog/worklogs/xml.html","/blog/itheima/Netty/Netty01-nio.html","/blog/itheima/Netty/Netty02.html","/blog/itheima/Netty/Netty03.html","/blog/itheima/Netty/Netty04.html","/blog/itheima/Netty/","/404.html","/category/","/category/%E5%BE%AE%E6%9C%8D%E5%8A%A1/","/category/ssm/","/category/%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/","/category/%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C/","/category/tool/","/category/work/","/category/itheima/","/tag/","/tag/elasticsearch/","/tag/spring-cloud/","/tag/rabbitmq/","/tag/redis/","/tag/mybatis/","/tag/mybatis-plus/","/tag/mysql/","/tag/quartz/","/tag/spring-springmvc/","/tag/xmind/","/tag/git/","/tag/maven/","/tag/nginx/","/tag/aliyun-oss/","/tag/markdown/","/tag/linux/","/tag/jenkins/","/tag/puppeteer/","/tag/action/","/tag/cron/","/tag/jasypt/","/tag/regex/","/tag/pdf/","/tag/xml/","/tag/netty/","/article/","/star/","/timeline/"],xe="SEARCH_PRO_QUERY_HISTORY",d=I(xe,[]),we=()=>{const{queryHistoryCount:s}=q,a=s>0;return{enabled:a,queryHistory:d,addQueryHistory:r=>{a&&(d.value=Array.from(new Set([r,...d.value.slice(0,s-1)])))},removeQueryHistory:r=>{d.value=[...d.value.slice(0,r),...d.value.slice(r+1)]}}},N=s=>He[s.id]+("anchor"in s?`#${s.anchor}`:""),qe="SEARCH_PRO_RESULT_HISTORY",{resultHistoryCount:$}=q,b=I(qe,[]),Ee=()=>{const s=$>0;return{enabled:s,resultHistory:b,addResultHistory:a=>{if(s){const r={link:N(a),display:a.display};"header"in a&&(r.header=a.header),b.value=[r,...b.value.slice(0,$-1)]}},removeResultHistory:a=>{b.value=[...b.value.slice(0,a),...b.value.slice(a+1)]}}},Re=s=>{const a=he(),r=_(),E=ve(),i=L(0),S=w(()=>i.value>0),m=me([]);return pe(()=>{const{search:p,terminate:R}=ye(),k=fe(c=>{const f=c.join(" "),{searchFilter:Q=v=>v,splitWord:C,suggestionsFilter:P,...y}=a.value;f?(i.value+=1,p(c.join(" "),r.value,y).then(v=>Q(v,f,r.value,E.value)).then(v=>{i.value-=1,m.value=v}).catch(v=>{console.warn(v),i.value-=1,i.value||(m.value=[])})):m.value=[]},q.searchDelay-q.suggestDelay);U([s,r],([c])=>k(c),{immediate:!0}),de(()=>{R()})}),{isSearching:S,results:m}};var Ce=te({name:"SearchResult",props:{queries:{type:Array,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(s,{emit:a}){const r=le(),E=_(),i=se(ae),{enabled:S,addQueryHistory:m,queryHistory:p,removeQueryHistory:R}=we(),{enabled:k,resultHistory:c,addResultHistory:f,removeResultHistory:Q}=Ee(),C=S||k,P=re(s,"queries"),{results:y,isSearching:v}=Re(P),o=oe({isQuery:!0,index:0}),g=L(0),h=L(0),j=w(()=>C&&(p.value.length>0||c.value.length>0)),M=w(()=>y.value.length>0),D=w(()=>y.value[g.value]||null),z=()=>{const{isQuery:e,index:t}=o;t===0?(o.isQuery=!e,o.index=e?c.value.length-1:p.value.length-1):o.index=t-1},Y=()=>{const{isQuery:e,index:t}=o;t===(e?p.value.length-1:c.value.length-1)?(o.isQuery=!e,o.index=0):o.index=t+1},G=()=>{g.value=g.value>0?g.value-1:y.value.length-1,h.value=D.value.contents.length-1},J=()=>{g.value=g.value<y.value.length-1?g.value+1:0,h.value=0},K=()=>{h.value<D.value.contents.length-1?h.value+=1:J()},V=()=>{h.value>0?h.value-=1:G()},A=e=>e.map(t=>Se(t)?t:l(t[0],t[1])),W=e=>{if(e.type==="customField"){const t=be[e.index]||"$content",[u,x=""]=ke(t)?t[E.value].split("$content"):t.split("$content");return e.display.map(n=>l("div",A([u,...n,x])))}return e.display.map(t=>l("div",A(t)))},H=()=>{g.value=0,h.value=0,a("updateQuery",""),a("close")},X=()=>S?l("ul",{class:"search-pro-result-list"},l("li",{class:"search-pro-result-list-item"},[l("div",{class:"search-pro-result-title"},i.value.queryHistory),p.value.map((e,t)=>l("div",{class:["search-pro-result-item",{active:o.isQuery&&o.index===t}],onClick:()=>{a("updateQuery",e)}},[l(O,{class:"search-pro-result-type"}),l("div",{class:"search-pro-result-content"},e),l("button",{class:"search-pro-remove-icon",innerHTML:T,onClick:u=>{u.preventDefault(),u.stopPropagation(),R(t)}})]))])):null,Z=()=>k?l("ul",{class:"search-pro-result-list"},l("li",{class:"search-pro-result-list-item"},[l("div",{class:"search-pro-result-title"},i.value.resultHistory),c.value.map((e,t)=>l(F,{to:e.link,class:["search-pro-result-item",{active:!o.isQuery&&o.index===t}],onClick:()=>{H()}},()=>[l(O,{class:"search-pro-result-type"}),l("div",{class:"search-pro-result-content"},[e.header?l("div",{class:"content-header"},e.header):null,l("div",e.display.map(u=>A(u)).flat())]),l("button",{class:"search-pro-remove-icon",innerHTML:T,onClick:u=>{u.preventDefault(),u.stopPropagation(),Q(t)}})]))])):null;return ie("keydown",e=>{if(s.isFocusing){if(M.value){if(e.key==="ArrowUp")V();else if(e.key==="ArrowDown")K();else if(e.key==="Enter"){const t=D.value.contents[h.value];m(s.queries.join(" ")),f(t),r.push(N(t)),H()}}else if(k){if(e.key==="ArrowUp")z();else if(e.key==="ArrowDown")Y();else if(e.key==="Enter"){const{index:t}=o;o.isQuery?(a("updateQuery",p.value[t]),e.preventDefault()):(r.push(c.value[t].link),H())}}}}),U([g,h],()=>{var e;(e=document.querySelector(".search-pro-result-list-item.active .search-pro-result-item.active"))==null||e.scrollIntoView(!1)},{flush:"post"}),()=>l("div",{class:["search-pro-result-wrapper",{empty:s.queries.length?!M.value:!j.value}],id:"search-pro-results"},s.queries.length?v.value?l(ue,{hint:i.value.searching}):M.value?l("ul",{class:"search-pro-result-list"},y.value.map(({title:e,contents:t},u)=>{const x=g.value===u;return l("li",{class:["search-pro-result-list-item",{active:x}]},[l("div",{class:"search-pro-result-title"},e||i.value.defaultTitle),t.map((n,ee)=>{const B=x&&h.value===ee;return l(F,{to:N(n),class:["search-pro-result-item",{active:B,"aria-selected":B}],onClick:()=>{m(s.queries.join(" ")),f(n),H()}},()=>[n.type==="text"?null:l(n.type==="title"?ne:n.type==="heading"?ce:ge,{class:"search-pro-result-type"}),l("div",{class:"search-pro-result-content"},[n.type==="text"&&n.header?l("div",{class:"content-header"},n.header):null,l("div",W(n))])])})])})):i.value.emptyResult:C?j.value?[X(),Z()]:i.value.emptyHistory:i.value.emptyResult)}});export{Ce as default};
